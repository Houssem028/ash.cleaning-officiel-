<!doctype html>
<html lang="ar" dir="rtl">
<head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>لوحة المدير</title>
<link rel="stylesheet" href="style.css">
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>
</head>
<body>
<div class="container">
  <h2>طلبات العملاء</h2>
  <table class="table" id="bookings-table">
    <thead><tr><th>الاسم</th><th>الهاتف</th><th>الخدمة</th><th>العنوان</th><th>التاريخ</th><th>الحالة</th></tr></thead>
    <tbody id="bookings-body"></tbody>
  </table>
  <p><button id="logout">تسجيل خروج</button></p>
</div>
<script src="firebase.js"></script>
<script>
const auth = firebase.auth();
auth.onAuthStateChanged(user => {
  if (!user) return window.location.href = 'login.html';
  window.db.collection('bookings').orderBy('createdAt','desc').onSnapshot(snap=>{
    const tbody = document.getElementById('bookings-body');
    tbody.innerHTML = '';
    snap.forEach(doc=>{
      const d = doc.data();
      tbody.innerHTML += `<tr>
        <td>${d.name}</td>
        <td>${d.phone}</td>
        <td>${d.service}</td>
        <td>${d.address}</td>
        <td>${d.date}</td>
        <td>${d.status}</td>
      </tr>`;
    });
  });
});
document.getElementById('logout').addEventListener('click', ()=>{
  auth.signOut().then(()=> window.location.href='login.html');
});
</script>
</body>
</html>
